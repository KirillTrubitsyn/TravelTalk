# План: Режим тренировки произношения

## Подход
**Гибридный**: быстрая оценка через сравнение текстов (Web Speech API) + кнопка «Подробный разбор» через Gemini AI.

## UI/UX
- Кнопка «Тренировать произношение» в `result-actions` каждой карточки перевода (text, voice, photo)
- При нажатии открывается полноэкранный оверлей с тренажёром
- Оверлей содержит:
  1. Целевая фраза (текст + кнопка повторного прослушивания TTS)
  2. Кнопка микрофона для записи попытки
  3. Распознанный текст пользователя
  4. Результат: пословное сравнение (зелёное=совпало, красное=ошибка) + общий процент
  5. Кнопка «Подробный разбор» → Gemini даёт советы по произношению
  6. Кнопка «Попробовать снова»

## Реализация

### 1. CSS стили (~60 строк)
- `.pronunciation-overlay` — полноэкранный оверлей
- `.pronunciation-card` — карточка тренажёра
- `.pronunciation-phrase` — отображение целевой фразы
- `.pronunciation-mic` — кнопка микрофона (переиспользуем стиль mic-ring)
- `.pronunciation-result` — блок результатов
- `.pronunciation-word.correct / .wrong` — подсветка слов
- `.pronunciation-score` — кольцевой индикатор процента
- `.pronunciation-tips` — блок с советами от AI

### 2. HTML (~40 строк)
- Оверлей `#pronunciationOverlay` после основного контента
- Кнопки «Тренировать произношение» в result-actions для text, voice, photo

### 3. JavaScript (~150 строк)
- `openPronunciationTrainer(text, lang)` — открывает оверлей, сохраняет целевую фразу
- `closePronunciationTrainer()` — закрывает оверлей, останавливает запись
- `playTargetPhrase()` — озвучивает целевую фразу через существующий speakText
- `startPronunciationRecording()` — запускает Web Speech API для записи попытки
- `evaluatePronunciation(target, spoken)` — сравнивает тексты пословно, возвращает score
- `renderPronunciationResult(target, spoken, score)` — отрисовывает результат с подсветкой
- `getPronunciationTips(target, spoken, lang)` — запрос к Gemini для подробного разбора
- `normalizeText(text)` — нормализация текста для сравнения

### 4. Алгоритм сравнения
- Нормализация: lowercase, удаление пунктуации, trim
- Разбиение на слова
- Longest Common Subsequence (LCS) для сопоставления слов
- Оценка: (совпавшие слова / всего слов целевой фразы) × 100%
- Визуальная подсветка: зелёный = совпало, красный = пропущено/неправильно

### 5. Gemini промпт для разбора
Отправляем целевой текст, распознанный текст, язык → получаем:
- Конкретные ошибки и правильное произношение
- Советы по интонации/ударению
- Транскрипцию сложных слов
